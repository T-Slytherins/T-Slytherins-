#!/usr/bin/env python3

"""
T-SLYTHERINS Main Script
"""

import sys
import os
import time
import threading
import subprocess
import shlex
from pathlib import Path

# Add the current directory to the Python path to allow module imports
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

try:
    from modules.progress import Spinner
    from modules import utils
except ImportError as e:
    print(f"[!] Import error: {e}", file=sys.stderr)
    print("[!] Make sure you are running from the correct directory and that modules/ exists.", file=sys.stderr)
    sys.exit(1)

banner = r"""
╔══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                                                                                      ║
║               _______      _______          __   __ _______ _     _ _______  ______ _____ __   _ _______             ║
║                  |         |______   |        \_/      |    |_____| |______ |_____/   |   | \  | |______             ║
║                  |         ______|   |_____    |       |    |     | |______ |    \_ __|__ |  \_|  ______|            ║
║                                                                                                                      ║
║                                            T-SLYTHERINS Reconnaissance Suite                                         ║
║                                                                                                                      ║
║           Advanced Automated Reconnaissance Framework ~ Owned by T-Slytherins ~ Crafted by Pr0fessor_SnApe           ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝
"""

print(banner)

def main():
    # Get target domain
    if len(sys.argv) > 1:
        domain = sys.argv[1]
    else:
        domain = input("[?] Enter target domain: ").strip()

    if not domain:
        print("[!] No domain provided", file=sys.stderr)
        sys.exit(1)

    # Create output directory
    output_dir = f"T-SLYTHERINS-OUTPUT-{domain}"
    Path(output_dir).mkdir(exist_ok=True)

    print(f"[*] Output directory: {output_dir}")

    # Initialize spinner
    spinner = Spinner()
    spinner.set_module_running("Subdomain Enumeration", True)
    spinner.set_module_running("DNS Reconnaissance", True)
    spinner.set_module_running("Port Scanning", True)
    spinner.set_module_running("Vulnerability Scanning", True)
    spinner.set_module_running("Screenshot Capture", True)

    spinner.start()

    # Simulate some work
    time.sleep(5)

    spinner.set_module_running("Subdomain Enumeration", False)
    spinner.set_module_running("DNS Reconnaissance", False)
    spinner.set_module_running("Port Scanning", False)
    spinner.set_module_running("Vulnerability Scanning", False)
    spinner.set_module_running("Screenshot Capture", False)

    spinner.stop()

    print("[✓] All modules completed.")

if __name__ == "__main__":
    main()
